<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>rGAI vignette</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">rGAI vignette</h1>



<div id="introduction-to-the-rgai-package" class="section level1">
<h1>Introduction to the rGAI package</h1>
<p>The rGAI package is an extension of functionality provided by <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/biom.12506">Dennis <em>et al</em> (2016)</a>. The package provides a user interface for calculating a Generalised Abundance Index (GAI) for seasonal invertebrates, with multiple options for covariate inclusion, seasonal flight patterns and observed count distributions, along with the ability to conduct bootstraps to obtain measures of uncertainty for estimated parameter and GAI values.</p>
<p>This vignette will illustrate the features available within the package by providing an example workflow on simulated data.</p>
</div>
<div id="installing-the-package-from-source" class="section level1">
<h1>Installing the Package from Source</h1>
<p>In order to install the <code>rGAI</code> package from source, the folder containing the source code must be downloaded from <a href="https://github.com/calliste-fagard-jenkin/rGAI">GitHub</a>, or installed via <code>install_github</code> in the <code>devtools</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">#library(devtools, quietly = T)</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">#install_github(&quot;calliste-fagard-jenkin/rGAI&quot;, quiet = F)</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(rGAI)</span></code></pre></div>
</div>
<div id="preparing-data-for-the-rgai-package" class="section level1">
<h1>Preparing Data for the <code>rGAI</code> package</h1>
<p>Let us begin by loading an example data set which is provided within the <code>rGAI</code> package, and examining its structure. These data consist of a simulation from a mixture model with three broods, across 50 sites and 26 occasions (one survey every week from April to September, inclusive, for a given year). The <code>rGAI</code> package comes with a handy function (<code>extract_counts</code>) to convert <code>data.frame</code> data to a matrix of counts, to facilitate plotting. This function also checks if the survey has any missing occasions, and so can be a useful way of sanitising a new dataset.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># For the pipe operator:</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">library</span>(magrittr)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">data</span>(<span class="st">&quot;example_data&quot;</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">head</span>(example_data)</span></code></pre></div>
<pre><code>##   site occasion count    altitude
## 1    1        1     0  1.75733303
## 2    2        1    NA -1.62156062
## 3    3        1     0  1.32982955
## 4    4        1     2 -1.20585806
## 5    5        1     1  1.02254356
## 6    6        1    NA -0.00204768</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>test_data &lt;-<span class="st"> </span><span class="kw">extract_counts</span>(example_data, <span class="dt">returnDF =</span> T)<span class="op">$</span>matrix</span>
<span id="cb4-2"><a href="#cb4-2"></a></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co"># Plot the observed densities, averaged across all sites:</span></span>
<span id="cb4-4"><a href="#cb4-4"></a>test_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">apply</span>(<span class="dv">2</span>, mean, <span class="dt">na.rm =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="st">  </span><span class="kw">plot</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(test_data), <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.6</span>), <span class="dt">lty =</span> <span class="dv">2</span>, </span>
<span id="cb4-6"><a href="#cb4-6"></a>       <span class="dt">xlab =</span> <span class="st">&#39;Week&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;Observed count, averaged across all sites&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Each row in our input <code>data.frame</code> is used to store the result of the observed count at a given site on a given occasion. We assume that the interval between each occasion is fixed, and that sites are independent. The ‘site’, ‘occasion’ and ‘count’ columns must be given these precise names to allow the <code>rGAI</code> package to recognise them. Missing observations can be listed with an NA entry.</p>
<p>Sites and occasions can have either character or numeric names. Because of this, the <code>rGAI</code> package will assume occasions occurred in the order they first appear in the data frame. If no observations were collected for any sites on a given occasion, this occasion should still be included in the <code>data.frame</code> with NA entries for each site.</p>
<p>The fourth column ‘altitude’ represents a covariate (with standardised values), and will be used to illustrate how covariates can be included into different models available within the package.</p>
</div>
<div id="fitting-a-simple-model" class="section level1">
<h1>Fitting a Simple Model</h1>
<p>As described by <a href="https://onlinelibrary.wiley.com/doi/full/10.1111/biom.12506">Dennis <em>et al</em> (2016)</a>, the Generalised Abundance Index is a model comprised of two parts. Firstly, the seasonal flight pattern describes the density of arrivals at each occasion in the study, and can be modelled either by a stopover model, a spline, or an n-component mixture model. The choice of seasonal flight pattern can be specified using the options <code>&quot;stopover&quot;</code>, <code>&quot;spline&quot;</code> and <code>&quot;mixture&quot;</code>, for each of the above options, respectively.</p>
<p>The second part of the GAI model describes the distribution of observed counts of individuals at each site on a given occasion. The package includes Poisson (<code>&quot;P&quot;</code>), Negative Binomial (<code>&quot;NB&quot;</code>) and Zero-Inflated Poisson (<code>&quot;ZIP&quot;</code>) as options for this distribution.</p>
<p>The <code>options</code> argument can be used to indicate if broods should all share the same standard deviation, or to provide the desired <code>degree</code> (of the polynomial) and <code>df</code> (degrees of freedom) of any splines used. The <code>verbose = TRUE</code> option can be used to display the negative log likelihood at each iteration of the model fitting process. The option <code>hessian = TRUE</code> can be used to tell the <code>fit_GAI</code> function to obtain an estimate of the hessian of the likelihood, which can be used to estimate the Fisher information.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># We can load the true parameter values of the simulated data set from the </span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co"># rGAI package, to more easily find starting parameter values for this example:</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="kw">data</span>(<span class="st">&quot;example_par&quot;</span>)</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co"># Options for mixture and stopover models:</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>my_options &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">B =</span> <span class="dv">3</span>, <span class="dt">shared_sigma =</span> T)</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co"># Options for spline models:</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>options_for_splines &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">df =</span> <span class="dv">20</span>, <span class="dt">degree =</span> <span class="dv">3</span>)</span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co"># Now, fitting the model:</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>my_mixture_GAI &lt;-<span class="st"> </span><span class="kw">fit_GAI</span>(<span class="dt">start =</span> example_par,</span>
<span id="cb5-13"><a href="#cb5-13"></a>                          <span class="dt">DF =</span> example_data, <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>,</span>
<span id="cb5-14"><a href="#cb5-14"></a>                          <span class="dt">dist_choice =</span> <span class="st">&quot;ZIP&quot;</span>, <span class="dt">options =</span> my_options,</span>
<span id="cb5-15"><a href="#cb5-15"></a>                          <span class="dt">verbose =</span> T, <span class="dt">hessian =</span> T)</span></code></pre></div>
<pre><code>## negative log likelihood for iteration 1 is 2173.199 
## negative log likelihood for iteration 2 is 1949.38 
## negative log likelihood for iteration 3 is 1949.361 
## final negative log likelihood value is 1949.361 
## performing final iteration to find hessian</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Print the MLEs to show the model has fitted correctly:</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>my_mixture_GAI<span class="op">$</span>par</span></code></pre></div>
<pre><code>##        mu1        mu2        mu3      sigma         w1         w2   dist.par 
##  1.4337224  2.2419141  2.1685615  0.6186303 -1.8263103  0.8410986  1.0681543</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># Not forgetting to add degrees of freedom and degree of splines information,</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co"># and noting that specifying the number of broods will no longer have an </span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co"># effect:</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>my_spline_GAI &lt;-<span class="st"> </span><span class="kw">fit_GAI</span>(<span class="dt">start =</span> <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">20</span>), <span class="dt">DF =</span> example_data,</span>
<span id="cb9-5"><a href="#cb9-5"></a>                         <span class="dt">a_choice =</span> <span class="st">&quot;splines&quot;</span>, <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>,</span>
<span id="cb9-6"><a href="#cb9-6"></a>                         <span class="dt">options =</span> options_for_splines, <span class="dt">verbose =</span> T,</span>
<span id="cb9-7"><a href="#cb9-7"></a>                         <span class="dt">hessian =</span> T)</span>
<span id="cb9-8"><a href="#cb9-8"></a></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co"># Print the MLEs to show the model has fitted correctly:</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>my_spline_GAI<span class="op">$</span>par</span></code></pre></div>
<pre><code>##  spline_par1  spline_par2  spline_par3  spline_par4  spline_par5  spline_par6 
##  -1.34995126  -1.82700039   0.94795141   0.26109310  -0.22835459  -1.04449485 
##  spline_par7  spline_par8  spline_par9 spline_par10 spline_par11 spline_par12 
##  -0.73915017  -0.26439482  -0.07875896   2.14861892   1.62543926   0.59656922 
## spline_par13 spline_par14 spline_par15 spline_par16 spline_par17 spline_par18 
##   0.07939401  -0.31428252  -0.66031778   1.03393481   0.19727176   0.60729954 
## spline_par19 spline_par20 
##  -0.82577107  -0.33537248</code></pre>
<p>If an incorrect number of starting values is given to <code>fit_GAI</code>, an error will be raised, and a printout will indicate the parameter starting values that <code>fit_GAI</code> expects. The order of these starting values is important, and matches the order of the output <code>fit_GAI</code> produces in this scenario. This feature should be used to avoid making mistakes when unsure of how many parameters a model specification will require. Confusingly, NA values are not allowed as starting values, but functionality exists within the code to aid in finding reasonable starting values, which is outlined later in this vignette.</p>
<p>It’s worth noting that multiple numerical methods exist for finding the MLEs of the GAI model. The package uses the <code>optim</code> function which makes use of the “Nelder-Mead” algorithm by default, but this can be changed to other options, such as “BFGS” or “SANN” (simulated annealing) by passing in <code>method = &quot;SANN&quot;</code> (for example) as an argument to <code>fit_GAI</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co"># We cut off some of our starting parameters on purpose, to cause the exception</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co"># to be raised:</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw">try</span>({my_mixture_GAI &lt;-<span class="st"> </span><span class="kw">fit_GAI</span>(<span class="dt">start =</span> example_par[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">DF =</span> example_data,</span>
<span id="cb11-4"><a href="#cb11-4"></a>                               <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>, <span class="dt">dist_choice =</span> <span class="st">&quot;ZIP&quot;</span>,</span>
<span id="cb11-5"><a href="#cb11-5"></a>                               <span class="dt">options =</span> my_options, <span class="dt">verbose =</span> T,</span>
<span id="cb11-6"><a href="#cb11-6"></a>                               <span class="dt">hessian =</span> T)}, <span class="dt">silent =</span> T)</span></code></pre></div>
<pre><code>## [1] &quot;Incorrect number of parameters supplied. Please submit something similar to:&quot;
##      mu1      mu2      mu3    sigma       w1       w2 dist.par 
##       NA       NA       NA       NA       NA       NA       NA</code></pre>
</div>
<div id="including-covariates" class="section level1">
<h1>Including Covariates</h1>
<p>Models using ‘mixture’ and ‘stopover’ seasonal flight patterns are able to include covariates on the values of the means, dispersions and weights for their normal distribution components.</p>
<p>Covariates can be included either as a general formula, which will apply to all broods, or be specified individually for each brood. Covariates for the normal components should be specified by adding a <code>mu_formula</code>, <code>sigma_formula</code>, or <code>w_formula</code> to the <code>options</code> argument, for the mean, standard deviation, and for weights of each component, respectively.</p>
<p>When specifying covariate formulae one by one for each brood, we have the option of giving completely different formulae for each brood, or using NULL to specify that no covariates should be fitted for a given brood. Because of this flexibility, it is good practice to ensure the list of formulae always has the same number of elements as the number of broods specified. If more formulae are specified than there are broods, these extra formulae will simply be ignored.</p>
<p>It should be noted that the value 0 is often used to initialise covariate parameters, and reflects the a priori assumption that the covariate has no effect. In the case of stopover models, this value leads to a probability of 0.5 for sojourning, once link functions have been applied.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># To specify a formula which will be identical for each brood, </span></span>
<span id="cb13-2"><a href="#cb13-2"></a>general_options &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">B =</span> <span class="dv">3</span>, <span class="dt">shared_sigma =</span> T,</span>
<span id="cb13-3"><a href="#cb13-3"></a>                        <span class="dt">mu_formula =</span> <span class="kw">formula</span>(<span class="op">~</span>altitude))</span>
<span id="cb13-4"><a href="#cb13-4"></a></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co"># To be able to fit brood-specific covariate options for the standard deviations</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co"># we require the standard deviation to be estimated individually for each brood,</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co"># and so we set shared_sigma = F.</span></span>
<span id="cb13-8"><a href="#cb13-8"></a>brood_specific_options &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">B =</span> <span class="dv">3</span>, <span class="dt">shared_sigma =</span> F, </span>
<span id="cb13-9"><a href="#cb13-9"></a>                               <span class="dt">sigma_formula =</span></span>
<span id="cb13-10"><a href="#cb13-10"></a>                                 <span class="kw">list</span>(<span class="ot">NULL</span>,                     <span class="co"># for brood 1</span></span>
<span id="cb13-11"><a href="#cb13-11"></a>                                      <span class="kw">formula</span>(<span class="op">~</span>altitude),       <span class="co"># for brood 2</span></span>
<span id="cb13-12"><a href="#cb13-12"></a>                                      <span class="kw">formula</span>(<span class="op">~</span><span class="kw">I</span>(altitude<span class="op">^</span><span class="dv">2</span>)))) <span class="co"># for brood 3</span></span>
<span id="cb13-13"><a href="#cb13-13"></a></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co"># We keep the same starting estimates as before, with 0 for the new parameter:</span></span>
<span id="cb13-15"><a href="#cb13-15"></a>general_fit_start &lt;-<span class="st"> </span>example_par[<span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(example_par) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>)</span>
<span id="cb13-16"><a href="#cb13-16"></a></span>
<span id="cb13-17"><a href="#cb13-17"></a><span class="co"># Having specified our covariate formulae, we can fit the model in exactly the</span></span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="co"># same way as before:</span></span>
<span id="cb13-19"><a href="#cb13-19"></a>general_fit &lt;-<span class="st"> </span><span class="kw">fit_GAI</span>(<span class="dt">start =</span> general_fit_start, <span class="dt">DF =</span> example_data,</span>
<span id="cb13-20"><a href="#cb13-20"></a>                       <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>, <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>,</span>
<span id="cb13-21"><a href="#cb13-21"></a>                       <span class="dt">options =</span> general_options, <span class="dt">hessian =</span> T)</span>
<span id="cb13-22"><a href="#cb13-22"></a></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co"># Because these covariate data are dummies, we expect the fitted value to be</span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="co"># very close to zero:</span></span>
<span id="cb13-25"><a href="#cb13-25"></a>general_fit<span class="op">$</span>par</span></code></pre></div>
<pre><code>##           mu1           mu2           mu3         sigma            w1 
##  1.429915e+00  2.243347e+00  2.173237e+00  6.004348e-01 -1.798173e+00 
##            w2        mu.cov 
##  8.709842e-01  8.863108e-05</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># To make the starting values for the new model, we steal the known values from </span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co"># the example_par vector (using the shared standard deviation across broods as</span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co"># the estimate for each brood individually). We then also add two 0s as our </span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co"># starting values for the covariate parameters</span></span>
<span id="cb15-5"><a href="#cb15-5"></a>brood_specific_start &lt;-<span class="st"> </span><span class="kw">c</span>(example_par[<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="kw">rep</span>(<span class="dv">4</span>, <span class="dv">3</span>), <span class="dv">5</span><span class="op">:</span><span class="dv">6</span>)], <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>))</span>
<span id="cb15-6"><a href="#cb15-6"></a>brood_specific_fit &lt;-<span class="st"> </span><span class="kw">fit_GAI</span>(<span class="dt">start =</span> brood_specific_start,</span>
<span id="cb15-7"><a href="#cb15-7"></a>                              <span class="dt">DF =</span> example_data, <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>,</span>
<span id="cb15-8"><a href="#cb15-8"></a>                              <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>, <span class="dt">hessian =</span> T,</span>
<span id="cb15-9"><a href="#cb15-9"></a>                              <span class="dt">options =</span> brood_specific_options)</span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co"># Checking the MLEs:</span></span>
<span id="cb15-11"><a href="#cb15-11"></a>brood_specific_fit<span class="op">$</span>par</span></code></pre></div>
<pre><code>##          mu1          mu2          mu3       sigma1       sigma2       sigma3 
##  1.436901645  2.237869583  2.174713412  0.626631568  0.576270591  0.659146988 
##           w1           w2   sigma2.cov   sigma3.cov 
## -1.796768365  0.857774072 -0.005153376  0.016057039</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># A quick example to show a stopover model with the same options:</span></span>
<span id="cb17-2"><a href="#cb17-2"></a>general_fit_stopover &lt;-<span class="st"> </span><span class="kw">fit_GAI</span>(<span class="dt">start =</span> <span class="kw">c</span>(general_fit_start, <span class="dv">0</span>),</span>
<span id="cb17-3"><a href="#cb17-3"></a>                                <span class="dt">DF =</span> example_data, <span class="dt">a_choice =</span> <span class="st">&quot;stopover&quot;</span>,</span>
<span id="cb17-4"><a href="#cb17-4"></a>                                <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>, <span class="dt">options =</span> general_options)</span>
<span id="cb17-5"><a href="#cb17-5"></a></span>
<span id="cb17-6"><a href="#cb17-6"></a>general_fit_stopover<span class="op">$</span>par</span></code></pre></div>
<pre><code>##          mu1          mu2          mu3        sigma           w1           w2 
##  1.106385585  2.232617499  2.194991766  0.383224172 -1.769072986  0.839033948 
##       mu.cov          phi 
##  0.001849519 -0.059001700</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>brood_specific_stopover &lt;-<span class="st"> </span><span class="kw">fit_GAI</span>(<span class="dt">start =</span> <span class="kw">c</span>(brood_specific_start, <span class="dv">0</span>),</span>
<span id="cb19-2"><a href="#cb19-2"></a>                                   <span class="dt">DF =</span> example_data, <span class="dt">a_choice =</span> <span class="st">&quot;stopover&quot;</span>,</span>
<span id="cb19-3"><a href="#cb19-3"></a>                                   <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>,</span>
<span id="cb19-4"><a href="#cb19-4"></a>                                   <span class="dt">options =</span> brood_specific_options)</span>
<span id="cb19-5"><a href="#cb19-5"></a></span>
<span id="cb19-6"><a href="#cb19-6"></a>brood_specific_stopover<span class="op">$</span>par</span></code></pre></div>
<pre><code>##          mu1          mu2          mu3       sigma1       sigma2       sigma3 
##  1.141209330  2.218430343  2.183833116  0.649536456  0.313634409  0.273854812 
##           w1           w2   sigma2.cov   sigma3.cov          phi 
## -1.751255740  0.851202315 -0.008961239  0.149464251  0.023362422</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># And of course, we could also fit covariates to the simple univolitine case</span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="co"># (although not for weights):</span></span>
<span id="cb21-3"><a href="#cb21-3"></a>univ_options &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">B =</span> <span class="dv">1</span>, <span class="dt">sigma_formula =</span> <span class="kw">formula</span>(<span class="op">~</span>altitude))</span>
<span id="cb21-4"><a href="#cb21-4"></a>univoltine_fit &lt;-<span class="st"> </span><span class="kw">fit_GAI</span>(<span class="dt">start =</span> <span class="kw">c</span>(<span class="fl">2.2</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">DF =</span> example_data, </span>
<span id="cb21-5"><a href="#cb21-5"></a>                          <span class="dt">a_choice =</span>  <span class="st">&quot;stopover&quot;</span>, <span class="dt">options =</span> univ_options)</span>
<span id="cb21-6"><a href="#cb21-6"></a></span>
<span id="cb21-7"><a href="#cb21-7"></a>univoltine_fit<span class="op">$</span>par</span></code></pre></div>
<pre><code>##         mu      sigma  sigma.cov        phi 
## 2.40983569 1.72757197 0.03859039 1.34817229</code></pre>
<p>It should be noted that the <code>rGAI</code> package comes with no methods for interpolating missing covariate values. Because of this, any NA covariate values in <code>data.frame</code> objects passed to <code>fit_GAI</code> will cause an error to be outputted to the console. The <code>rGAI</code> package only supports ‘spatial’ covariates, that is, covariates whose values vary only by site, and are identical for every single sampling occasion, for a given site. Supplying time-varying covariates to <code>fit_GAI</code> will similarly lead to an error being thrown.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>example_NA &lt;-<span class="st"> </span>example_time_varying &lt;-<span class="st"> </span>example_data</span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co"># Turn roughly 5% of our altitude data to NA values:</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>indices &lt;-<span class="st"> </span>example_NA<span class="op">$</span>altitude <span class="op">%&gt;%</span><span class="st"> </span>length <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">rbinom</span>(<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="fl">0.05</span>)</span>
<span id="cb23-5"><a href="#cb23-5"></a>example_NA<span class="op">$</span>altitude[indices <span class="op">%&gt;%</span><span class="st"> </span>as.logical] &lt;-<span class="st"> </span><span class="ot">NA</span></span>
<span id="cb23-6"><a href="#cb23-6"></a></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co"># Turn our altitude data into a time-varying covariate by making it a function </span></span>
<span id="cb23-8"><a href="#cb23-8"></a><span class="co"># of the occasion:</span></span>
<span id="cb23-9"><a href="#cb23-9"></a>example_time_varying<span class="op">$</span>altitude &lt;-<span class="st"> </span>example_data<span class="op">$</span>altitude <span class="op">*</span><span class="st"> </span>example_data<span class="op">$</span>occasion</span>
<span id="cb23-10"><a href="#cb23-10"></a></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="co"># Trying to fit a covariate model with these new data will throw the relevant</span></span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="co"># errors:</span></span>
<span id="cb23-13"><a href="#cb23-13"></a>error_fit &lt;-<span class="st"> </span><span class="kw">try</span>(<span class="kw">fit_GAI</span>(<span class="dt">start =</span> general_fit_start, <span class="dt">DF =</span> example_NA,</span>
<span id="cb23-14"><a href="#cb23-14"></a>                         <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>, <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>,</span>
<span id="cb23-15"><a href="#cb23-15"></a>                         <span class="dt">options =</span> general_options, <span class="dt">hessian =</span> T))</span></code></pre></div>
<pre><code>## Error in design_matrix(DF, formulas) : Covariate values cannot include NA</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># Trying to fit with a time-varying formula: </span></span>
<span id="cb25-2"><a href="#cb25-2"></a>error_fit &lt;-<span class="st"> </span><span class="kw">try</span>(<span class="kw">fit_GAI</span>(<span class="dt">start =</span> general_fit_start, <span class="dt">DF =</span> example_time_varying,</span>
<span id="cb25-3"><a href="#cb25-3"></a>                         <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>, <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>,</span>
<span id="cb25-4"><a href="#cb25-4"></a>                         <span class="dt">options =</span> general_options, <span class="dt">hessian =</span> T))</span></code></pre></div>
<pre><code>## Error in get_cov_skeleton_and_DM(&quot;mu&quot;, options, DF, B, skeleton, DMs) : 
##   Covariate values must vary by site only, and not through time</code></pre>
</div>
<div id="finding-starting-values" class="section level1">
<h1>Finding Starting Values</h1>
<p>To aid numerical routines in estimating the maximum likelihood estimates of parameter values, link functions are used to ensure that parameter guesses can always be made on the entire real line. Because many broods can be used, the <code>rGAI</code> package uses custom link functions for mean arrival times and dispersions, which are slightly more complicated than the typical log and logistic link functions.</p>
<p>The <code>fit_GAI</code> function expects all starting values to be given on this link scale, which can make using our intuition or knowledge of our data very difficult to produce good starting values. To remedy this, the <code>transform_starting_values</code> function can be used to transform parameter guesses on the ‘real world’ scale to the link scale.</p>
<p>In the below chunk, we annotate the previous plot of observed counts. Adding in lines to mark estimates of the mean brood arrival times, and horizontal lines for the estimates of the standard deviation in arrival times for each brood. By assuming that most observations are contained within two standard deviations of the mean, we use the half width of a single horizontal bar as an estimate of the standard deviation. To estimate the component weights, we assume the height of the peak of a brood’s component in the mixture is roughly proportional to the percentage of the population that are in that brood.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>test_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">apply</span>(<span class="dv">2</span>, mean, <span class="dt">na.rm =</span> T) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="st">  </span><span class="kw">plot</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(test_data), <span class="dt">type =</span> <span class="st">&#39;l&#39;</span>, <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.6</span>), <span class="dt">lty =</span> <span class="dv">2</span>, </span>
<span id="cb27-3"><a href="#cb27-3"></a>       <span class="dt">xlab =</span> <span class="st">&#39;Week&#39;</span>, <span class="dt">ylab =</span> <span class="st">&#39;Observed count, averaged across all sites&#39;</span>)</span>
<span id="cb27-4"><a href="#cb27-4"></a></span>
<span id="cb27-5"><a href="#cb27-5"></a>plot.col &lt;-<span class="st"> &#39;blue&#39;</span></span>
<span id="cb27-6"><a href="#cb27-6"></a>plot.base &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb27-7"><a href="#cb27-7"></a></span>
<span id="cb27-8"><a href="#cb27-8"></a><span class="co"># Mean brood arrival lines:</span></span>
<span id="cb27-9"><a href="#cb27-9"></a><span class="kw">lines</span>(<span class="kw">rep</span>(<span class="fl">4.1</span>, <span class="dv">2</span>), <span class="kw">c</span>(plot.base, <span class="fl">4.6</span>), <span class="dt">col =</span> plot.col)</span>
<span id="cb27-10"><a href="#cb27-10"></a><span class="kw">lines</span>(<span class="kw">rep</span>(<span class="fl">13.0</span>, <span class="dv">2</span>), <span class="kw">c</span>(plot.base, <span class="fl">21.3</span>), <span class="dt">col =</span> plot.col)</span>
<span id="cb27-11"><a href="#cb27-11"></a><span class="kw">lines</span>(<span class="kw">rep</span>(<span class="fl">23.0</span>, <span class="dv">2</span>), <span class="kw">c</span>(plot.base, <span class="dv">8</span>), <span class="dt">col =</span> plot.col) </span>
<span id="cb27-12"><a href="#cb27-12"></a></span>
<span id="cb27-13"><a href="#cb27-13"></a><span class="co"># Mean brood dispersion lines:</span></span>
<span id="cb27-14"><a href="#cb27-14"></a><span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">7.5</span>), <span class="kw">rep</span>(plot.base, <span class="dv">2</span>), <span class="dt">col =</span> plot.col)</span>
<span id="cb27-15"><a href="#cb27-15"></a><span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">18</span>), <span class="kw">rep</span>(plot.base, <span class="dv">2</span>), <span class="dt">col =</span> plot.col)</span>
<span id="cb27-16"><a href="#cb27-16"></a><span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">19</span>, <span class="dv">26</span>), <span class="kw">rep</span>(plot.base, <span class="dv">2</span>), <span class="dt">col =</span> plot.col)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># The length of the three horizontal bars that measure the width of our broods:</span></span>
<span id="cb28-2"><a href="#cb28-2"></a>brood_widths &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">6.5</span>, <span class="dv">9</span>, <span class="dv">7</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a>sigma_guesses &lt;-<span class="st"> </span>brood_widths <span class="op">/</span><span class="st"> </span><span class="dv">4</span></span>
<span id="cb28-4"><a href="#cb28-4"></a></span>
<span id="cb28-5"><a href="#cb28-5"></a>w_guesses &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">4.6</span> <span class="op">-</span><span class="st"> </span>plot.base, <span class="fl">21.3</span> <span class="op">-</span><span class="st"> </span>plot.base, <span class="dv">8</span> <span class="op">-</span><span class="st"> </span>plot.base) <span class="op">%&gt;%</span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="st">  </span>sum_to_one</span>
<span id="cb28-7"><a href="#cb28-7"></a></span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="co"># Our guesses for the means can simply be read off of the lines of code that</span></span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="co"># produced the plot:</span></span>
<span id="cb28-10"><a href="#cb28-10"></a>mu_guesses &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">4.1</span>, <span class="dv">13</span>, <span class="dv">23</span>)</span></code></pre></div>
<p>Let’s consider our <code>brood_specific_fit</code> once more, but using the <code>transform_starting_values</code> function to obtain better starting values, without knowing the distribution our data came from. The <code>transform_starting_values</code> function will assume that 0 is a reasonable starting value for all covariate parameters and spline parameters, which usually leads to numerically sound estimation of the MLEs. However, if covariates aren’t normalised, and have large magnitude, this won’t be the case. Note that in the case of zero-inflated poisson or negative binomial count distributions, an initial guess for the additional distributional parameter can also be provided, using the name <code>dist.par</code>. When covariates are included in a model specification, we must also make sure the <code>transform_starting_values</code> function is supplied with the <code>data.frame</code> of observations, with the argument <code>DF</code>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="co"># We create a list of starting values for parameters with the same structure </span></span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="co"># as the options argument for fit_GAI:</span></span>
<span id="cb29-3"><a href="#cb29-3"></a>my_starting_guesses &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">mu =</span> mu_guesses, <span class="dt">sigma =</span> sigma_guesses,</span>
<span id="cb29-4"><a href="#cb29-4"></a>                            <span class="dt">w =</span> w_guesses)</span>
<span id="cb29-5"><a href="#cb29-5"></a></span>
<span id="cb29-6"><a href="#cb29-6"></a>new_brood_specific_start &lt;-</span>
<span id="cb29-7"><a href="#cb29-7"></a><span class="st">  </span><span class="kw">transform_starting_values</span>(<span class="dt">starting_values =</span> my_starting_guesses,</span>
<span id="cb29-8"><a href="#cb29-8"></a>                            <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>, <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>,</span>
<span id="cb29-9"><a href="#cb29-9"></a>                            <span class="dt">options =</span> brood_specific_options,</span>
<span id="cb29-10"><a href="#cb29-10"></a>                            <span class="dt">DF =</span> example_data)</span>
<span id="cb29-11"><a href="#cb29-11"></a></span>
<span id="cb29-12"><a href="#cb29-12"></a><span class="co"># Let&#39;s print these new starting values, and refit the model:</span></span>
<span id="cb29-13"><a href="#cb29-13"></a><span class="kw">print</span>(new_brood_specific_start)</span></code></pre></div>
<pre><code>##        mu1        mu2        mu3     sigma1     sigma2     sigma3         w1 
##  1.4109870  2.1860513  2.3025851  0.4855078  0.8109302  0.5596158 -2.0259529 
##         w2 sigma2.cov sigma3.cov 
##  1.0647107  0.0000000  0.0000000</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>new_brood_specific_fit &lt;-<span class="st"> </span><span class="kw">fit_GAI</span>(<span class="dt">start =</span> new_brood_specific_start,</span>
<span id="cb31-2"><a href="#cb31-2"></a>                                  <span class="dt">DF =</span> example_data, <span class="dt">a_choice =</span> <span class="st">&quot;mixture&quot;</span>,</span>
<span id="cb31-3"><a href="#cb31-3"></a>                                  <span class="dt">dist_choice =</span> <span class="st">&quot;P&quot;</span>, <span class="dt">hessian =</span> T,</span>
<span id="cb31-4"><a href="#cb31-4"></a>                                  <span class="dt">options =</span> brood_specific_options)</span>
<span id="cb31-5"><a href="#cb31-5"></a><span class="co"># Checking the MLEs:</span></span>
<span id="cb31-6"><a href="#cb31-6"></a>new_brood_specific_fit<span class="op">$</span>par</span></code></pre></div>
<pre><code>##         mu1         mu2         mu3      sigma1      sigma2      sigma3 
##  1.40519030  2.24749501  2.17431670  0.65785402  0.58835258  0.58970295 
##          w1          w2  sigma2.cov  sigma3.cov 
## -1.80712133  0.85020834  0.01517904  0.07809616</code></pre>
</div>
<div id="using-bootstraps" class="section level1">
<h1>Using Bootstraps</h1>
<p>Bootstraps in the <code>rGAI</code> package are available with two options. The first option will resample sites (and their covariate values) from the observed data set, refitting the model each time it does this. It then extracts the bootstrap distribution of estimated site superpopulation sizes and parameter estimates to create a quantile method confidence interval for these. Because this type of bootstrap can be incredibly computionally expensive, functionality has been provided to do these calculations in parallel.</p>
<p>The second method of bootstrapping involves resampling parameter values from their asymptotic multivariate normal distribution. This involves a numerical estimate of the Fisher Information matrix, and so is only available if a model has been fitted with the <code>hessian = TRUE</code> option in <code>fit_GAI</code>.</p>
<p>The second type of bootstrap runs considerably faster, and is likely to be the only available option when many sites or covariates have been included, due to computational constrains. However, it should be noted that the first type typically produces intervals with coverage closer to the target, as it has no dependence on asymptotic properties or estimates of the Information matrix.</p>
<p>Bootstraps can be produced for transformed covariates, for models with and without covariates, in both the ‘refit the model’, and the ‘resample the MLEs’ case.</p>
<p>The option <code>R</code> within the <code>bootstrap</code> function allows us to specify the number of bootstrap iterations the function should perform. <code>refit = TRUE</code> selects the ‘refit the model’ style of bootstrap. <code>alpha</code> specifies the targeted coverage of the bootstrap, and <code>transform = TRUE</code> indicates the bootstrap should be performed on transformed output parameter values (on the parameter scale, as opposed to the link function scale). The <code>cores</code> option will be used to determine the number of cores used to perform the calculation in parallel, when this is possible. The default value is one less than the number of cores on the device, and therefore, it is important to specify this value when using any computing devices which are shared between multiple users.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>general_fit_bootstrap &lt;-<span class="st"> </span><span class="kw">bootstrap</span>(general_fit, <span class="dt">R =</span> <span class="dv">500</span>, <span class="dt">refit =</span> F,</span>
<span id="cb33-2"><a href="#cb33-2"></a>                                   <span class="dt">alpha =</span> <span class="fl">0.01</span>, <span class="dt">transform =</span> T)</span></code></pre></div>
<pre><code>## Loading required package: mvtnorm</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>refitting_bootstrap &lt;-<span class="st"> </span><span class="kw">bootstrap</span>(general_fit, <span class="dt">R =</span> <span class="dv">9</span>, <span class="dt">refit =</span> T, <span class="dt">parallel =</span> F,</span>
<span id="cb36-2"><a href="#cb36-2"></a>                                 <span class="dt">cores =</span> <span class="dv">3</span>, <span class="dt">alpha =</span> <span class="fl">0.01</span>, <span class="dt">transform =</span> T)</span>
<span id="cb36-3"><a href="#cb36-3"></a></span>
<span id="cb36-4"><a href="#cb36-4"></a>untransformed_bootstrap &lt;-<span class="st"> </span><span class="kw">bootstrap</span>(general_fit, <span class="dt">R =</span> <span class="dv">500</span>, <span class="dt">refit =</span> F,</span>
<span id="cb36-5"><a href="#cb36-5"></a>                                     <span class="dt">transform =</span> F, <span class="dt">alpha =</span> <span class="fl">0.01</span>)</span></code></pre></div>
<p>The bootstraps output contains raw values from each iteration of the estimated parameter values, the flight path densities for each site and occasion, the estimated site totals (site super-populations), and the average estimated site total. The <span class="math inline">\(1 - \alpha\)</span> confidence intervals are available in the <code>$par</code>, <code>$sites</code> and <code>$index</code> elements of the bootstrap output for the parameters, individual site totals and average site total, respectively:</p>
<p>Bootstrap outputs for parameters can also be transformed for a range of custom covariate functions, in order to produce plots, or for interpolation. This is done with the <code>transform_bootstrap_parameters&#39; function, which can take as argument an input</code>data.frame<code>of parameter values, a fitted model object  produced from the</code>fit_GAI<code>function (which it uses to extract model specifications and design matrices), and a</code>data.frame` of custom covariate values for which parameter scale transformations are desired.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>refitting_bootstrap<span class="op">$</span>par            <span class="co"># parameter estimates</span></span></code></pre></div>
<pre><code>##            mu1      mu2      mu3    sigma        w1        w2
## 0.5%  4.057843 13.45347 22.26071 1.790030 0.1308123 0.5902394
## 99.5% 4.266624 13.73628 22.55009 1.882441 0.1548677 0.6213869</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a>refitting_bootstrap<span class="op">$</span>N[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]        <span class="co"># site super-population estimates</span></span></code></pre></div>
<pre><code>##         Site_1   Site_2   Site_3   Site_4   Site_5
## 0.5%   94.5407 119.0991 105.7722 102.6660 101.5264
## 99.5% 169.5409 193.5043 183.8367 203.4688 179.2862</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>refitting_bootstrap<span class="op">$</span>EC[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]  <span class="co"># expected counts at each site, per occasion</span></span></code></pre></div>
<pre><code>## , , Occasion_1
## 
##          Site_1   Site_2    Site_3   Site_4    Site_5
## 0.5%  0.6868554 0.782287 0.7117908 0.724273 0.6748023
## 99.5% 1.2523342 1.287437 1.2453046 1.452360 1.2893212
## 
## , , Occasion_2
## 
##         Site_1   Site_2   Site_3   Site_4   Site_5
## 0.5%  1.481946 1.769265 1.579974 1.574018 1.507296
## 99.5% 2.762170 2.868490 2.855344 3.120076 2.812819</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="kw">transform_bootstrap_parameters</span>(untransformed_bootstrap<span class="op">$</span>par, general_fit, </span>
<span id="cb43-2"><a href="#cb43-2"></a>                               <span class="kw">data.frame</span>(<span class="dt">altitude =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1e2</span>, <span class="dv">0</span>, <span class="fl">1e2</span>)))</span></code></pre></div>
<pre><code>## $`0.5%`
##        mu1       mu2      mu3   sigma1        w1        w2
## 1 6.050247 19.968497 33.04093 1.775732 0.1283894 0.5998131
## 2 3.998492 13.196796 21.83611 1.775732 0.1283894 0.5998131
## 3 2.642527  8.721509 14.43107 1.775732 0.1283894 0.5998131
## 
## $`99.5%`
##        mu1       mu2      mu3   sigma1       w1        w2
## 1 2.829736  9.080539 14.88316 1.870595 0.154523 0.6104226
## 2 4.363208 14.001406 22.94854 1.870595 0.154523 0.6104226
## 3 6.727689 21.588955 35.38466 1.870595 0.154523 0.6104226</code></pre>
</div>
<div id="model-outputs" class="section level1">
<h1>Model Outputs</h1>
<p>The <code>rGAI</code> package comes with some simple functionality for summarising models, as well as more detailed outputs, which will be covered in more detail. The standard R <code>summary</code> function can be used to see the model’s AIC, average estimate site total across all sites, and also the MLEs for all model parameters.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># Get a basic summary of the model outputs:</span></span>
<span id="cb45-2"><a href="#cb45-2"></a><span class="kw">summary</span>(my_mixture_GAI)</span></code></pre></div>
<pre><code>## Maximum Likelihood Estimates (MLEs):
## 
##      mu1      mu2      mu3    sigma       w1       w2 dist.par 
##   1.4340   2.2420   2.1690   0.6186  -1.8260   0.8411   1.0680 
## 
## 
## MLE Standard Errors:
## 
##      mu1      mu2      mu3    sigma       w1       w2 dist.par 
## 0.019520 0.009344 0.007614 0.011750 0.040660 0.033120 0.081890 
## 
## 
## Akaike&#39;s Information Criterion (AIC): 3912.722 
## 
## Average estimated site super-population size: 150.2755</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># We can also obtain the AIC on its own using the standard AIC R function if </span></span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="co"># we aren&#39;t interested in producing the rest of the summary:</span></span>
<span id="cb47-3"><a href="#cb47-3"></a><span class="kw">AIC</span>(my_mixture_GAI)</span></code></pre></div>
<pre><code>## [1] 3912.722</code></pre>
<p>The output of the <code>fit_GAI</code> function is a list with a few important elements. The <code>par</code> element gives named estimates of the MLEs for the model parameters, with <code>value</code> giving the value of the negative log likelihood evaluated at the MLEs. <code>counts</code>, <code>convergence</code>, <code>message</code> and <code>hessian</code> are all standard outputs given by the <code>optim</code> function with details on the numerical process of estimating the MLEs. <code>spline_specs</code> contains the user-specified options for fitting splines, and will be an empty list for mixture and stopover models. <code>dist_choice</code> and <code>a_choice</code> contain the count distribution and flight path distributions, respectively. <code>skeleton</code> contains the skeleton list of parameter values that the package uses to fit the model, with <code>options</code> being the list of options passed to <code>fit_GAI</code>. <code>maxiter</code> refers to the maximum number of iterations used to estimate the MLEs of ZIP and NB models. <code>A</code> and <code>N</code> contain the matrix of estimated seasonal densities at each site and occasion, and the vector of estimated site totals, respectively. <code>DMs</code> contains the list of design matrices used by the <code>rGAI</code> package to include the selected covariate formulas in the model. <code>obs</code> contains the count observations in matrix form, with sites as rows and occasions as columns. This is the same format as for <code>A</code>. <code>DF</code> contains the original <code>data.frame</code> supplied to <code>fit_GAI</code>, and finally, <code>tol</code> specififies the stopping condition used for the model (an epsilon such that during an iterative process for fitting a ZIP or NB model, a difference of less than epsilon in the negative log likelihood between two iterations causes the process to terminate).</p>
</div>
<div id="transforming-parameter-estimates" class="section level1">
<h1>Transforming Parameter Estimates</h1>
<p>Numerical solvers that attempt to find MLEs must be able to perform guesses anywhere on the real scale. This causes issues with certain parameters which can only take on values in a particular range, such as probabilities which must always be between 0 and 1, for example. Further to this, the estimation of values such as mean arrival times for broods can be unidentifiable if specified ambiguously. In this example, unless we force the mean for the second brood to be greater than that for the first (and so forth), then multiple sets of parameters could give the same maximal value of the log likelihood. For these reasons, the <code>rGAI</code> package uses link functions to map between the real line on which we make parameter value guesses during fitting, and the ‘parameter space’, where all parameters are within their correct bounds.</p>
<p>In order to be able to interpret our output values, we must apply the relevant link functions to transform them back to the appropriate scale. For mu parameters this can be done with the <code>means_link</code> function. For standard deviations, a log-link is used, and so fitted values should be exponentiated. Weights also use a custom link function, which can be applied to fitted values using the <code>probs_link</code> function. The extra distributional parameter for the ZIP uses a logistic link (by virtue of being a probability), which can be applied with the <code>plogis</code> function, whereas the rate parameter for an NB model should be exponentiated, to ensure it is always positive. Sojourning probabilities in stopover models also make use of the logistic link (<code>plogis</code>).</p>
<p>The <code>transform_output</code> function within the <code>rGAI</code> package uses model settings stored in the fitted model object to apply these link functions automatically, making sure that the effect of covariates has also been taken into account.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># We can create a `data.frame` with custom covariate values, or reuse values that</span></span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="co"># we observed during the survey:</span></span>
<span id="cb49-3"><a href="#cb49-3"></a>DF_to_transform &lt;-<span class="st"> `</span><span class="dt">data.frame</span><span class="st">`</span>(<span class="dt">altitude =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">1e2</span>, <span class="dv">0</span>, <span class="fl">1e2</span>))</span>
<span id="cb49-4"><a href="#cb49-4"></a>DF_to_transform &lt;-<span class="st"> </span>general_fit<span class="op">$</span>DF[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,]</span>
<span id="cb49-5"><a href="#cb49-5"></a></span>
<span id="cb49-6"><a href="#cb49-6"></a><span class="co"># The transform_output function deals with all the covariate formulas and link</span></span>
<span id="cb49-7"><a href="#cb49-7"></a><span class="co"># functions by using the information contained in the fitted model object:</span></span>
<span id="cb49-8"><a href="#cb49-8"></a><span class="kw">transform_output</span>(general_fit, DF_to_transform)</span></code></pre></div>
<pre><code>##        mu1      mu2      mu3   sigma1        w1        w2
## 1 4.178996 13.60529 22.39334 1.822911 0.1420737 0.6047956
## 2 4.177745 13.60122 22.38664 1.822911 0.1420737 0.6047956
## 3 4.178838 13.60478 22.39249 1.822911 0.1420737 0.6047956</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># When no covariates were included in the model, a blank `data.frame`, or no </span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="co"># `data.frame` at all can be used to only provide the transformed values:</span></span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="kw">transform_output</span>(my_mixture_GAI)</span></code></pre></div>
<pre><code>##           mu1      mu2      mu3   sigma1        w1        w2  dist.par
## [1,] 4.194283 13.60561 22.35131 1.856384 0.1386784 0.6018024 0.7442458</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># We can also use this function to get out the a_func matrix for a set of</span></span>
<span id="cb53-2"><a href="#cb53-2"></a><span class="co"># covariate values:</span></span>
<span id="cb53-3"><a href="#cb53-3"></a>A &lt;-<span class="st"> </span><span class="kw">transform_output</span>(general_fit, DF_to_transform, <span class="dt">provide_A =</span> T)<span class="op">$</span>A</span>
<span id="cb53-4"><a href="#cb53-4"></a>    </span>
<span id="cb53-5"><a href="#cb53-5"></a><span class="co"># It&#39;s important to include all covariates exactly as they were named in the </span></span>
<span id="cb53-6"><a href="#cb53-6"></a><span class="co"># call to fit_GAI, otherwise an error will be thrown, giving the name of the </span></span>
<span id="cb53-7"><a href="#cb53-7"></a><span class="co"># missing covariate.</span></span>
<span id="cb53-8"><a href="#cb53-8"></a><span class="kw">try</span>(<span class="kw">transform_output</span>(brood_specific_fit, <span class="st">`</span><span class="dt">data.frame</span><span class="st">`</span>(<span class="dt">altiitude =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>))))</span></code></pre></div>
<pre><code>## Error in eval(predvars, data, env) : object &#39;altitude&#39; not found</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="co"># NA covariate values will throw an error, as always:</span></span>
<span id="cb55-2"><a href="#cb55-2"></a><span class="kw">try</span>(<span class="kw">transform_output</span>(brood_specific_fit, <span class="st">`</span><span class="dt">data.frame</span><span class="st">`</span>(<span class="dt">altitude =</span> <span class="kw">c</span>(<span class="ot">NA</span>, <span class="dv">0</span>, <span class="dv">10</span>))))</span></code></pre></div>
<pre><code>## Error in design_matrix(DF, current_formula) : 
##   Covariate values cannot include NA</code></pre>
</div>
<div id="plotting-fitted-curves" class="section level1">
<h1>Plotting Fitted Curves</h1>
<p>The standard R <code>plot</code> function can be used to produce simple plots of the flight path of a fitted model. Optionally, either the flight path for each site can be included as a separate curve on the same graph, or a smooth can be plotted instead. This smooth averages through the different values observed at each site, at a set of quantiles that can be specified by the user. The default behaviour produces plots for the median density across sites for a given occasion, as well as the 5th and 95th quantiles for flight path density.</p>
<p>To better compare the relative abundance at each site throughout the year, especially when covariates have been included in the model, it can be useful to scale the flight path curve of each site by the estimated site total. This can be done by setting <code>scale_by_N = TRUE</code> in the call to the <code>plot</code> function.</p>
<p>If custom colours are to be used by the plotting function, the colour palette can be passed to the <code>plot</code> function as a vector of integers or character colour hex values using the <code>colours</code> argument.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>colours &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;#33FFF9&quot;</span>, <span class="st">&quot;#33A8FF&quot;</span>, <span class="st">&quot;#4233FF&quot;</span>)</span>
<span id="cb57-2"><a href="#cb57-2"></a></span>
<span id="cb57-3"><a href="#cb57-3"></a><span class="co"># The default behaviour will use quantiles = c(0.05, 0.5, 0.95), and therefore </span></span>
<span id="cb57-4"><a href="#cb57-4"></a><span class="co"># will not plot all sites individually.</span></span>
<span id="cb57-5"><a href="#cb57-5"></a><span class="kw">plot</span>(general_fit, <span class="dt">scale_by_N =</span> T, <span class="dt">quantiles =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.99</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="co"># For the sake of demonstration, a plot with manual colours, with no scaling:</span></span>
<span id="cb58-2"><a href="#cb58-2"></a><span class="kw">plot</span>(brood_specific_fit, <span class="dt">scale_by_N =</span> F, <span class="dt">quantiles =</span> <span class="kw">c</span>(<span class="fl">0.001</span>, <span class="fl">0.5</span>, <span class="fl">0.999</span>),</span>
<span id="cb58-3"><a href="#cb58-3"></a>     <span class="dt">colours =</span> colours)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
